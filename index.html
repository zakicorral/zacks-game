<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  // Game state
  let isPlaying = false;
  let score = 0;
  let frame = 0;

  // Player
  const player = {
    x: 50,
    y: 300,
    width: 72,
    height: 72,
    dy: 0,
    jumpPower: -12,
    grounded: false,
    sprite: new Image()
  };
  player.sprite.src = "images/idle.png"; // use idle.png for now

  // Background layers
  const sky = new Image(); sky.src = "images/1.png";
  const clouds = new Image(); clouds.src = "images/2.png";
  const farGround = new Image(); farGround.src = "images/3.png";
  const closeGround = new Image(); closeGround.src = "images/4.png";
  const bird = new Image(); bird.src = "images/5.png";

  // Scrolling positions
  let bgLayers = [
    { img: sky, x: 0, speed: 0.2 },
    { img: clouds, x: 0, speed: 0.5 },
    { img: farGround, x: 0, speed: 1.5 },
    { img: closeGround, x: 0, speed: 3 }
  ];

  function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    frame++;

    // Background layers scroll
    bgLayers.forEach(layer => {
      layer.x -= layer.speed;
      if (layer.x <= -canvas.width) layer.x = 0;
      ctx.drawImage(layer.img, layer.x, 0, canvas.width, canvas.height);
      ctx.drawImage(layer.img, layer.x + canvas.width, 0, canvas.width, canvas.height);
    });

    // Bird floating
    let birdY = 100 + Math.sin(frame * 0.05) * 10;
    ctx.drawImage(bird, 600, birdY, 60, 60);

    // Player physics
    player.y += player.dy;
    if (player.y + player.height < 380) {
      player.dy += 0.6; // gravity
      player.grounded = false;
    } else {
      player.y = 380 - player.height;
      player.dy = 0;
      player.grounded = true;
    }

    // Draw player (idle image for now)
    ctx.drawImage(player.sprite, player.x, player.y, player.width, player.height);

    if (isPlaying) requestAnimationFrame(update);
  }

  function jump() {
    if (player.grounded) {
      player.dy = player.jumpPower;
      player.sprite.src = "images/jump.png"; // switch to jump
    }
  }

  function gameOver() {
    isPlaying = false;
    player.sprite.src = "images/dead.png"; // show dead
    alert("Game Over! Final Score: " + score);
    location.reload();
  }

  // Controls
  document.addEventListener("keydown", e => {
    if (e.code === "Space") jump();
  });

  document.getElementById("startBtn").addEventListener("click", () => {
    isPlaying = true;
    score = 0;
    document.getElementById("score").innerText = score;
    update();
    document.getElementById("startBtn").style.display = "none";
  });
</script>
